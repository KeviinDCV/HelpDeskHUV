import{c as de,j as e,L as S,u as Ce,a as i,H as Se,r as H}from"./app-YaCHBeCQ.js";import{T as ge,C as O,M as _e,G as Te,b as Re,U as ae,a as Me}from"./glpi-footer-BBspjELl.js";import{C as le,a as re,b as ie,c as ne}from"./card-DcP071l1.js";import{C as Ie,a as Pe,U as z}from"./users-C-8M3Elf.js";import{a as B,B as f}from"./button-XV45NBY6.js";import{P as $e}from"./plus-DjgsN6bG.js";import{S as De,a as Ae,b as Fe,c as Le,d as Ue}from"./select-DkrGR65G.js";import{g as E}from"./index-DKtf60Sy.js";import{C as ce,F as He}from"./file-text-Cg4jmGOx.js";import{E as ze}from"./eye-UrZlED3y.js";import{S as oe}from"./square-check-big-MjsOsNnW.js";import{X as V}from"./x-CodjfeFc.js";import{L as q}from"./loader-circle-Dlud4818.js";import{T as Ee}from"./tag-DHcZtZp-.js";import{U as Ve}from"./index-DUAtfEeD.js";/* empty css            */import"./dialog-CbSfokH7.js";import"./index-CIGhyOBb.js";import"./index-BcOxxyD-.js";import"./index-BY6XSydF.js";import"./input-ByvO7L7M.js";import"./monitor-b9lDHlLw.js";import"./check-ujP9CZ4n.js";import"./sun--lqutQJT.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Oe=B("MapPin",qe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ge=B("UserCheck",Be);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],We=B("Zap",Ze);function Xe(_){const s=de.c(25),{stats:r}=_;let u;s[0]===Symbol.for("react.memo_cache_sentinel")?(u=e.jsx(le,{className:"pb-2 px-3 sm:px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-4 w-4 text-[#2c5599]"}),e.jsx(re,{className:"text-sm font-semibold text-[#2c5599]",children:"Resumen"})]})}),s[0]=u):u=s[0];let N;s[1]===Symbol.for("react.memo_cache_sentinel")?(N=e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-1 lg:gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 lg:w-4 lg:h-4 text-blue-500"}),e.jsx("span",{className:"text-xs lg:text-sm text-gray-700",children:"Mis casos"})]}),s[1]=N):N=s[1];let o;s[2]!==r.myTickets?(o=e.jsx(S,{href:"/soporte/casos?filter=my_cases",className:"block",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between p-2 bg-blue-50 hover:bg-blue-100 transition-colors cursor-pointer text-center lg:text-left",children:[N,e.jsx("span",{className:"font-bold text-blue-600 text-lg lg:text-base",children:r.myTickets})]})}),s[2]=r.myTickets,s[3]=o):o=s[3];let d;s[4]===Symbol.for("react.memo_cache_sentinel")?(d=e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-1 lg:gap-2",children:[e.jsx(ge,{className:"w-5 h-5 lg:w-4 lg:h-4 text-red-500"}),e.jsx("span",{className:"text-xs lg:text-sm text-gray-700",children:"Sin asignar"})]}),s[4]=d):d=s[4];let p;s[5]!==r.publicUnassigned?(p=e.jsx(S,{href:"/soporte/casos?filter=unassigned",className:"block",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between p-2 bg-red-50 hover:bg-red-100 transition-colors cursor-pointer text-center lg:text-left",children:[d,e.jsx("span",{className:"font-bold text-red-600 text-lg lg:text-base",children:r.publicUnassigned})]})}),s[5]=r.publicUnassigned,s[6]=p):p=s[6];let m;s[7]===Symbol.for("react.memo_cache_sentinel")?(m=e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-1 lg:gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 lg:w-4 lg:h-4 text-green-500"}),e.jsx("span",{className:"text-xs lg:text-sm text-gray-700",children:"Resueltos"})]}),s[7]=m):m=s[7];let n;s[8]!==r.myResolved?(n=e.jsx(S,{href:"/soporte/casos?filter=my_resolved",className:"block",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between p-2 bg-green-50 hover:bg-green-100 transition-colors cursor-pointer text-center lg:text-left",children:[m,e.jsx("span",{className:"font-bold text-green-600 text-lg lg:text-base",children:r.myResolved})]})}),s[8]=r.myResolved,s[9]=n):n=s[9];let c;s[10]===Symbol.for("react.memo_cache_sentinel")?(c=e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-1 lg:gap-2",children:[e.jsx(O,{className:"w-5 h-5 lg:w-4 lg:h-4 text-orange-500"}),e.jsx("span",{className:"text-xs lg:text-sm text-gray-700",children:"Sin resolver"})]}),s[10]=c):c=s[10];let g;s[11]!==r.myPending?(g=e.jsx(S,{href:"/soporte/casos?filter=my_pending",className:"block",children:e.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between p-2 bg-orange-50 hover:bg-orange-100 transition-colors cursor-pointer text-center lg:text-left",children:[c,e.jsx("span",{className:"font-bold text-orange-600 text-lg lg:text-base",children:r.myPending})]})}),s[11]=r.myPending,s[12]=g):g=s[12];let h;s[13]!==o||s[14]!==p||s[15]!==n||s[16]!==g?(h=e.jsxs(ie,{className:"bg-white border shadow-sm",children:[u,e.jsx(ne,{className:"px-3 sm:px-6",children:e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-1 gap-2 lg:space-y-3 lg:gap-0",children:[o,p,n,g]})})]}),s[13]=o,s[14]=p,s[15]=n,s[16]=g,s[17]=h):h=s[17];let x;s[18]===Symbol.for("react.memo_cache_sentinel")?(x=e.jsx(le,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4 text-[#2c5599]"}),e.jsx(re,{className:"text-sm font-semibold text-[#2c5599]",children:"Shortcuts"})]})}),s[18]=x):x=s[18];let w;s[19]===Symbol.for("react.memo_cache_sentinel")?(w=e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:e.jsx($e,{className:"w-4 h-4 text-white"})}),s[19]=w):w=s[19];let k;s[20]===Symbol.for("react.memo_cache_sentinel")?(k=e.jsx(S,{href:"/soporte/crear-caso",className:"block",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 hover:bg-blue-100 transition-colors rounded-lg cursor-pointer group",children:[w,e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Crear nuevo caso"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Reportar un problema o solicitud"})]})]})}),s[20]=k):k=s[20];let b;s[21]===Symbol.for("react.memo_cache_sentinel")?(b=e.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center group-hover:bg-green-700 transition-colors",children:e.jsx(_e,{className:"w-4 h-4 text-white"})}),s[21]=b):b=s[21];let C;s[22]===Symbol.for("react.memo_cache_sentinel")?(C=e.jsx("div",{className:"hidden lg:block space-y-4",children:e.jsxs(ie,{className:"bg-white border shadow-sm",children:[x,e.jsxs(ne,{className:"space-y-2",children:[k,e.jsx(S,{href:"/reportar?from=dashboard",target:"_blank",className:"block",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 hover:bg-green-100 transition-colors rounded-lg cursor-pointer group",children:[b,e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Reportar Caso (IA)"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Portal público para usuarios"})]})]})})]})]})}),s[22]=C):C=s[22];let T;return s[23]!==h?(T=e.jsxs("div",{className:"w-full lg:w-80 space-y-4",children:[h,C]}),s[23]=h,s[24]=T):T=s[24],T}function Ye(_){const s=de.c(11),{activeTab:r,onTabChange:u,publicCount:N,myCount:o}=_,d=N===void 0?0:N,p=o===void 0?0:o;let m;s[0]!==d?(m={name:"Reportes Públicos",count:d},s[0]=d,s[1]=m):m=s[1];let n;s[2]!==p?(n={name:"Mis Reportes",count:p},s[2]=p,s[3]=n):n=s[3];let c;s[4]!==m||s[5]!==n?(c=[m,n],s[4]=m,s[5]=n,s[6]=c):c=s[6];const g=c;let h;return s[7]!==r||s[8]!==u||s[9]!==g?(h=e.jsx("div",{className:"px-3 sm:px-6 pt-4 sm:pt-6 pb-2 sm:pb-4",children:e.jsx("div",{className:"bg-white shadow-sm border border-gray-200 inline-flex w-full sm:w-auto",children:g.map(x=>e.jsxs(f,{variant:"ghost",onClick:()=>u(x.name),className:`flex-1 sm:flex-initial px-3 sm:px-6 py-2 sm:py-2.5 text-xs sm:text-sm font-medium transition-colors ${r===x.name?"bg-[#2c4370] text-white hover:bg-[#2c4370]":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[x.name,x.count>0&&e.jsx("span",{className:`ml-2 px-1.5 py-0.5 text-[10px] font-bold ${r===x.name?"bg-white/20 text-white":"bg-red-500 text-white"}`,children:x.count})]},x.name))})}),s[7]=r,s[8]=u,s[9]=g,s[10]=h):h=s[10],h}const me={1:"bg-gray-100 text-gray-600",2:"bg-blue-100 text-blue-600",3:"bg-yellow-100 text-yellow-700",4:"bg-orange-100 text-orange-600",5:"bg-red-100 text-red-600",6:"bg-red-200 text-red-700"},xe={1:"bg-blue-100 text-blue-700",2:"bg-yellow-100 text-yellow-700",3:"bg-purple-100 text-purple-700",4:"bg-orange-100 text-orange-700",5:"bg-green-100 text-green-700",6:"bg-gray-100 text-gray-600"};function ys({publicTickets:_,myTickets:s,stats:r,technicians:u,auth:N}){const{props:o}=Ce(),[d,p]=i.useState("Reportes Públicos"),[m,n]=i.useState(null),c=i.useRef(null),g=i.useRef("Reportes Públicos"),[h,x]=i.useState(_),[w,k]=i.useState(s),[b,C]=i.useState(r),[T,G]=i.useState(!1),[a,y]=i.useState({open:!1,ticket:null,loading:!1}),[M,I]=i.useState({open:!1,ticketId:null,ticketName:""}),[P,Z]=i.useState(""),[W,X]=i.useState(!1),[$,D]=i.useState({open:!1,ticketId:null,ticketName:""}),[A,U]=i.useState(""),[Y,F]=i.useState(""),[J,K]=i.useState(!1),Q=N?.user?.role==="Administrador",R=async()=>{if(document.visibilityState==="visible"){G(!0);try{const t=await fetch("/dashboard/tickets");if(t.ok){const l=await t.json();x(l.publicTickets),k(l.myTickets),C(l.stats)}}catch{}finally{G(!1)}}};i.useEffect(()=>{let t=null;const l=()=>{t||(t=setInterval(R,3e4))},j=()=>{t&&(clearInterval(t),t=null)},L=()=>{document.visibilityState==="visible"?(R(),l()):j()};return l(),document.addEventListener("visibilitychange",L),()=>{j(),document.removeEventListener("visibilitychange",L)}},[]);const he=async t=>{y({open:!0,ticket:null,loading:!0});try{const l=await fetch(`/dashboard/ticket/${t}`);if(l.ok){const j=await l.json();y({open:!0,ticket:j,loading:!1})}}catch{y({open:!1,ticket:null,loading:!1})}},ee=(t,l)=>{I({open:!0,ticketId:t,ticketName:l}),Z("")},pe=()=>{!M.ticketId||!P||(X(!0),H.post(`/dashboard/assign-ticket/${M.ticketId}`,{technician_id:P},{onFinish:()=>{X(!1),I({open:!1,ticketId:null,ticketName:""}),R()}}))},fe=(t,l)=>{D({open:!0,ticketId:t,ticketName:l}),U("");const j=new Date,L=j.getFullYear(),Ne=String(j.getMonth()+1).padStart(2,"0"),ye=String(j.getDate()).padStart(2,"0"),ve=String(j.getHours()).padStart(2,"0"),we=String(j.getMinutes()).padStart(2,"0"),ke=`${L}-${Ne}-${ye}T${ve}:${we}`;F(ke)},ue=()=>{!$.ticketId||!A.trim()||(K(!0),H.post(`/dashboard/solve-ticket/${$.ticketId}`,{solution:A.trim(),solve_date:Y||void 0},{onFinish:()=>{K(!1),D({open:!1,ticketId:null,ticketName:""}),U(""),F(""),R()}}))},se=t=>{n(t),H.post(`/dashboard/take-ticket/${t}`,{},{onFinish:()=>{n(null),R()}})},be=t=>{const l=document.createElement("div");return l.innerHTML=t,l.textContent||l.innerText||""},je=t=>{if(t===d||!c.current)return;const l=g.current==="Reportes Públicos"&&t==="Mis Reportes";E.to(c.current,{x:l?-100:100,opacity:0,duration:.3,ease:"power2.inOut",onComplete:()=>{p(t),g.current=t,E.set(c.current,{x:l?100:-100,opacity:0}),E.to(c.current,{x:0,opacity:1,duration:.3,ease:"power2.inOut"})}})},te=d==="Reportes Públicos"?h:w,v=d==="Reportes Públicos";return e.jsxs(e.Fragment,{children:[e.jsx(Se,{title:"HelpDesk HUV - Dashboard"}),e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(Te,{}),e.jsxs("main",{className:"flex-1 bg-gray-50",children:[e.jsx(Ye,{activeTab:d,onTabChange:je,publicCount:b.publicUnassigned,myCount:b.myTickets}),o.flash?.success&&e.jsxs("div",{className:"mx-3 sm:mx-6 mt-4 bg-green-50 border border-green-200 p-3 sm:p-4 flex items-center gap-3",children:[e.jsx(ce,{className:"w-5 h-5 text-green-600 shrink-0"}),e.jsx("span",{className:"text-green-700 text-sm sm:text-base",children:o.flash.success})]}),o.flash?.error&&e.jsxs("div",{className:"mx-3 sm:mx-6 mt-4 bg-red-50 border border-red-200 p-3 sm:p-4 flex items-center gap-3",children:[e.jsx(Re,{className:"w-5 h-5 text-red-600 shrink-0"}),e.jsx("span",{className:"text-red-700 text-sm sm:text-base",children:o.flash.error})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 p-3 sm:p-4",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{ref:c,className:"bg-white shadow-sm border border-gray-200",style:{willChange:"transform"},children:[e.jsx("div",{className:"px-4 sm:px-6 py-3 sm:py-4 border-b flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-wrap",children:[v?e.jsx(ge,{className:"w-5 h-5 text-[#2c4370] shrink-0"}):e.jsx(He,{className:"w-5 h-5 text-[#2c4370] shrink-0"}),e.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-800",children:v?"Reportes Públicos":"Mis Reportes"}),e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 sm:px-2.5 sm:py-1 ${v?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:v?`${b.publicUnassigned} pendientes`:`${b.myTickets} activos`})]})}),te.length===0?e.jsxs("div",{className:"p-8 sm:p-12 text-center",children:[e.jsx(ce,{className:"w-10 h-10 sm:w-12 sm:h-12 text-green-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:v?"No hay reportes públicos pendientes":"No tienes reportes abiertos"})]}):e.jsx("div",{className:"divide-y",children:te.map(t=>e.jsx("div",{className:"p-3 sm:p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-1 flex-wrap",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:["#",t.id]}),e.jsx("span",{className:`text-xs font-medium px-1.5 sm:px-2 py-0.5 ${me[t.priority]}`,children:t.priority_name}),!v&&e.jsx("span",{className:`text-xs font-medium px-1.5 sm:px-2 py-0.5 ${xe[t.status]}`,children:t.status_name}),t.category_name&&e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-1.5 sm:px-2 py-0.5 hidden sm:inline",children:t.category_name})]}),e.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base line-clamp-2 sm:truncate",children:t.name}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-1 line-clamp-2 hidden sm:block",children:[be(t.content).substring(0,150),"..."]}),e.jsx("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-400",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-3 h-3"}),new Date(t.date_creation).toLocaleDateString("es-CO",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})]})})]}),e.jsxs("div",{className:"flex gap-1.5 sm:gap-2 shrink-0",children:[e.jsxs(f,{variant:"outline",size:"sm",className:"text-xs sm:text-sm px-2 sm:px-3",onClick:()=>he(t.id),children:[e.jsx(ze,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Ver"})]}),v?e.jsxs(e.Fragment,{children:[e.jsxs(f,{onClick:()=>se(t.id),disabled:m===t.id,size:"sm",className:"bg-[#2c4370] hover:bg-[#3d5583] text-white text-xs sm:text-sm px-2 sm:px-3",children:[e.jsx(ae,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:m===t.id?"Tomando...":"Tomar"})]}),Q&&e.jsxs(f,{size:"sm",className:"bg-[#2c4370] hover:bg-[#3d5583] text-white text-xs sm:text-sm px-2 sm:px-3",onClick:()=>ee(t.id,t.name),children:[e.jsx(z,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Asignar"})]})]}):e.jsxs(f,{onClick:()=>fe(t.id,t.name),size:"sm",className:"bg-green-600 hover:bg-green-700 text-white text-xs sm:text-sm px-2 sm:px-3",children:[e.jsx(oe,{className:"w-4 h-4 sm:mr-1"}),e.jsx("span",{className:"hidden sm:inline",children:"Resolver"})]})]})]})},t.id))})]})}),e.jsx(Xe,{stats:b})]})]}),e.jsx(Me,{})]}),a.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b sticky top-0 bg-white",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detalles del Caso"}),e.jsx("button",{onClick:()=>y({open:!1,ticket:null,loading:!1}),className:"p-1 hover:bg-gray-100",children:e.jsx(V,{className:"w-5 h-5"})})]}),a.loading?e.jsx("div",{className:"p-12 flex items-center justify-center",children:e.jsx(q,{className:"w-8 h-8 animate-spin text-[#2c4370]"})}):a.ticket&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["#",a.ticket.id]}),e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 ${me[a.ticket.priority]}`,children:a.ticket.priority_name}),e.jsx("span",{className:`text-xs font-medium px-2 py-0.5 ${xe[a.ticket.status]}`,children:a.ticket.status_name})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:a.ticket.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.ticket.category_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:a.ticket.category_name})]}),a.ticket.location_name&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:a.ticket.location_name})]}),a.ticket.assigned_tech&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:a.ticket.assigned_tech})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:new Date(a.ticket.date_creation).toLocaleString("es-CO")})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Descripción"}),e.jsx("div",{className:"prose prose-sm max-w-none text-gray-600 bg-gray-50 p-4 border border-gray-200",dangerouslySetInnerHTML:{__html:a.ticket.content}})]}),a.ticket.solution&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-green-700 mb-2",children:"Solución"}),e.jsxs("div",{className:"bg-green-50 p-4 border border-green-200",children:[e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:a.ticket.solution.content}}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200 flex items-center justify-between text-xs text-green-700",children:[e.jsxs("span",{children:["Resuelto por: ",e.jsx("strong",{children:a.ticket.solution.solved_by||"Usuario del sistema"})]}),e.jsx("span",{children:new Date(a.ticket.solution.date_creation).toLocaleString("es-CO")})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(f,{variant:"outline",onClick:()=>y({open:!1,ticket:null,loading:!1}),children:"Cerrar"}),a.ticket.status===1&&e.jsxs(e.Fragment,{children:[e.jsxs(f,{onClick:()=>{y({open:!1,ticket:null,loading:!1}),se(a.ticket.id)},className:"bg-[#2c4370] hover:bg-[#3d5583] text-white",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"Tomar"]}),Q&&e.jsxs(f,{className:"bg-[#2c4370] hover:bg-[#3d5583] text-white",onClick:()=>{y({open:!1,ticket:null,loading:!1}),ee(a.ticket.id,a.ticket.name)},children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"Asignar"]})]})]})]})]})}),M.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white shadow-xl max-w-md w-full border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Asignar Caso"}),e.jsx("button",{onClick:()=>I({open:!1,ticketId:null,ticketName:""}),className:"p-1 hover:bg-gray-100",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Asignar el caso ",e.jsxs("strong",{children:['"',M.ticketName,'"']})," a:"]}),e.jsxs(De,{value:P,onValueChange:Z,children:[e.jsx(Ae,{className:"w-full",children:e.jsx(Fe,{placeholder:"Seleccionar técnico..."})}),e.jsx(Le,{children:u?.map(t=>e.jsx(Ue,{value:t.id.toString(),children:t.name},t.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t",children:[e.jsx(f,{variant:"outline",onClick:()=>I({open:!1,ticketId:null,ticketName:""}),children:"Cancelar"}),e.jsx(f,{onClick:pe,disabled:!P||W,className:"bg-[#2c4370] hover:bg-[#3d5583] text-white",children:W?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-1 animate-spin"}),"Asignando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"Asignar"]})})]})]})}),$.open&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white shadow-xl max-w-lg w-full border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Resolver Caso"}),e.jsx("button",{onClick:()=>D({open:!1,ticketId:null,ticketName:""}),className:"p-1 hover:bg-gray-100",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Resolver el caso ",e.jsxs("strong",{children:['"',$.ticketName,'"']})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Descripción de la solución ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:A,onChange:t=>U(t.target.value),placeholder:"Describe cómo se resolvió el problema...",className:"w-full px-3 py-2 border focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 min-h-[120px]",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha y hora de solución"}),e.jsx("input",{type:"datetime-local",value:Y,onChange:t=>F(t.target.value),className:"w-full px-3 py-2 border focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Por defecto se usa la fecha y hora actual. Puede modificarla si la solución fue en otro momento."})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 p-4 border-t",children:[e.jsx(f,{variant:"outline",onClick:()=>{D({open:!1,ticketId:null,ticketName:""}),F("")},children:"Cancelar"}),e.jsx(f,{onClick:ue,disabled:!A.trim()||J,className:"bg-green-600 hover:bg-green-700 text-white",children:J?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4 mr-1 animate-spin"}),"Resolviendo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"Resolver"]})})]})]})})]})}export{ys as default};
